<!DOCTYPE html>
  <html>
    <head>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="apple-mobile-web-app-title" content="Swap Thing">
    <meta name="application-name" content="Swap Thing">
    <meta name="theme-color" content="#ffffff">
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!--CSS-->
    <link type="text/css" rel="stylesheet" href="../css/materialize.min.css"  media="screen,projection"/>
    
    <link href='https://fonts.googleapis.com/css?family=Raleway:400,700,600' rel='stylesheet' type='text/css'>

    <link href='https://fonts.googleapis.com/css?family=Covered+By+Your+Grace' rel='stylesheet' type='text/css'>

    <link href='https://fonts.googleapis.com/css?family=Abel' rel='stylesheet' type='text/css'>

    <link href="../css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  </head>

  <body>

  <nav>
    <div class="nav-wrapper">
      <a class="brand-logo swap left">SwapThing</a>
      <ul id="nav-mobile" class="right">
          <li class="search">
            <div class="nav-wrapper">
                  <form>
                    <div class="input-field">
                      <input id="search" type="search" required>
                      <label for="search"><i class="material-icons">search</i></label>
                      <i class="material-icons">close</i>
                    </div>
                  </form>
                </div>
          <li><a id="logout" href="#">Logout</a></li>
          </li>
      </ul>
    </div>
  </nav>
  <main>

  <div class="container" id="maincontainer">
    <div class="row">

      <!-- Sidebar Navigation (image) -->
      {{#with loggedUser}}

      <div class="col l2">
        <div class="toc-wrapper pin-top" style="top: 0px;">

          <img src="{{userImage}}" class="circle responsive-img">

          <!-- Side Navigation Links  -->
          <br>
          <br>
          <blockquote>
          <ul class="links">
            <li><a class="modal-trigger" href="#postAProduct">Post Product</a></li>
            <li><a class="torequests" href="#swapped">Swap Requests</a></li>
            <li><a href="/manageView">Manage Swaps</a></li>
          </ul>
          </blockquote>

        </div>
      </div>

      <!-- Swap Info Area -->
      <div class="col s12 m10 l10">
        <div>
          <!-- NAME here -->
          <div id="username">

          <h2>Welcome, {{firstName}}!</h2>
            <h5>Time to get swapping</h5>
            <br>
            <hr>
          {{/with}}
          </div>

          <!-- Get Swapping TXT -->
          <br>
          <div id="toswap">
            <h5>Check out your friend's awesome stuff</h5>
          </div>

          <!-- Friends Items Row -->

          <div class="row">

          {{#each allProducts}}
            <div class="col s12 m3">
              <div class="card">
                <div class="card-image waves-effect waves-block waves-light">

                  <img class="activator" src="{{imageURL}}">
                </div>
                <div class="card-content">
                  <span class="card-title activator grey-text text-darken-4">{{product_name}}<i class="material-icons right">more_vert</i></span>
                  <p><a class="modal-trigger" href="#swapAProduct">Request a swap</a></p>
                </div>
                <difv class="card-reveal">
                  <span class="card-title grey-text text-darken-4">{{product_name}}<i class="material-icons right">close</i></span>
                  <p>Item category: {{category}}</p>
                  <p>Product description: {{description}}</p>
                  <p>Amount of use: {{scale_rating}}</p>

                  {{!-- <p>Sold By: {{firstName}}</p> --}}

                </div>
              </div>

            {{/each}}
            </div>


          <div id="swapped">
            <h5>Pending Swap Requests</h5>
          </div>


          <!-- Swapped Items -->

    {{!--       {{#each swappings}}
                {{secondPersonProductID}}
          {{/each}}
 --}}
          <div class="row">
          {{#each secondPersonNames}}

            <div class="col s12 m3">

              <div class="card">

                <!--///we can show a picture of the item them own that they would like to swap with you/// -->


                <div class="card-image">
                  <img src="{{../allProducts}}#{{../swappings.secondPersonProductID}}{{imageURL}}">


                </div>

                <div class="card-content">
                  <p> {{firstName}} would like to swap your [FirstUserItem] for their [SecondUserProduct]</p>
                </div>

                <div class="card-action">
                  <a class= "modal-trigger blueClick" href="#congrats">Accept Swap</a>
                  <br>
                  <a class="modal-trigger" href="#reject">Reject Swap</a>
                </div>

              </div>

            </div>

          {{/each}}
          </div>


      <!-- Swap Modal Structure -->
      <div id="swapAProduct" class="modal">
        <div class="modal-content">
            <button id="clear-modal" class="modal-close btn-flat" style="position:absolute;top:0;right:0;">X</button>
          <h4>Get your swap on!</h4>
          <br>
              <div class="row">
                <div class="col s12 l5">
                <img src= "../css/imgs/placeholder/nikes.jpg" class="responsive-img" id="wantedProduct">
                </div>
                <div class="icon-block col s12 l2">
                  <h3 class="center"><i class="material-icons medium blueIcon swapArrow">swap_calls</i></h3>
              </div>
              <div class="input-field col s12 l5">
                <select class="icons">
                  <option value="" selected>What's it worth trading for?</option>
                  <option value="1" data-icon="../css/imgs/placeholder/desk.jpg" class="left circle data-icon">Desk</option>
                  <option value="2" data-icon="../css/imgs/placeholder/makeuppalette.jpg" class="left circle data-icon">MakeUp Palette</option>
                  <option value="3" data-icon="../css/imgs/placeholder/polaroid_camera.jpg" class="left circle data-icon">Polaroid Camera</option>
                </select>
              </div>
              </div>
              <div class="row">
              <div class="modal-footer">
                  <button class="btn waves-effect waves-light right" type="submit" name="action" id="finishSwap" onclick ="window.location.href ='/'">Make a Swap!
                  </button>
              </div>
              </div>
        </div>
      </div>

    <!-- Post a Product Modal Structure -->
    <div id="postAProduct" class="modal">
      <div class="modal-content">
        <button id="clearModal" input="reset" class="modal-close btn-flat" type="reset" style="position:absolute;top:0;right:0;">X</button>
        <h4>Post A Product</h4>
        <p>Tell us a bit about what you're swapping</p>
          <form>
          <div class="row">
            <div class="input-field col s6">
                <input id="product_name" type="text" class="validate">
                <label class="active" for="product_name">Product Name</label>
            </div>
            <div class="input-field col s6">
                <input id="product_description" type="text" class="validate">
                <label class="active" for="product_description">Product Description</label>
            </div>
           </div>
           <div class="row">
              <div class="input-field col s12">
                <input id="imageURL" type="url" class="validate">
                <label class="active" for="imageURL">Input Image URL</label>
              </div>
            </div>
            <form id="catergory-product" action="#">
              <h5>Pick one category for your product</h5>
              <p>
                <input class="with-gap" name="category" type="radio" id="beauty" value="Beauty/Health"/>
                <label for="beauty">Beauty/Health</label>

                <input class="with-gap" name="category" type="radio" id="electronic" value="Electronics"/>
                <label for="electronic">Electronics</label>

                <input class="with-gap" name="category" type="radio" id="apparel" value="Apparel"/>
                <label for="apparel">Apparel</label>

                <input class="with-gap" name="category" type="radio" id="media" value="Media"/>
                <label for="media">Media</label>

                <input class="with-gap" name="category" type="radio" id="house" value="Household Goods"/>
                <label for="house">Household Goods</label>

                <input class="with-gap" name="category" type="radio" id="other" value="Other"/>
                <label for="other">Other</label>
              </p>
            </form>
            <br>

            <form id="radioForm" action="#">
            <h5>What condition is your product in?</h5>
              <p>
                <input class="with-gap" name="condition" type="radio" id="1" value="1"/>
                <label for="1">Heavily used</label>

                <input class="with-gap" name="condition" type="radio" id="2" value="2"/>
                <label for="2">More than average use</label>

                <input class="with-gap" name="condition" type="radio" id="3" value="3"/>
                <label for="3">Used from time to time</label>

                <input class="with-gap" name="condition" type="radio" id="4" value="4"/>
                <label for="4">Hardly used</label>

                <input class="with-gap" name="condition" type="radio" id="5" value="5"/>
                <label for="5">Basically new</label> 
              </p>
            </form>
            <br>

          </form>
          <div class="modal-footer">
            <button class="btn waves-effect waves-light left" type="submit" name="action" id="postProduct" onclick ="window.location.href ='/manageView'">Post Your Product
            </button>
          </div>
      </div>
    </div>

      <!-- Accept Modal Structure -->
        <div id="congrats" class="modal">
        <div class="modal-content">
          <button class="modal-close btn-flat" style="position:absolute;top:0;right:0;">X</button>
          <h4>CONGRATS!</h4>
          <p>It's is all yours! Be sure to contact your friend to make arrangements!</p>
        </div>
        <div class="modal-footer">
          <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Keep Swapping</a>
        </div>
      </div>

      <!-- Reject Modal Structure -->
      <div id="reject" class="modal">
      <div class="modal-content">
          <button class="modal-close btn-flat" style="position:absolute;top:0;right:0;">X</button>
        <h4>No problem, better swapping next time!</h4>
        <p>Your item will be returned back to your shop and your friend will be notified! Be sure to check out their shop to see if there is something else you would be willing to trade.</p>
      </div>
      <div class="modal-footer">
        <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Keep Swapping</a>
      </div>
    </div>


      </div>

    </main>
    
    <footer class="page-footer blue" id="page-footer">
      <div class="container">
        <div class="row">
        </div>
      </div>
      <div class="footer-copyright pinkT">
        <div class="container">
        </div>
      </div>
    </footer>



      <!--Import jQuery before materialize.js-->
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      <script type="text/javascript" src="../js/materialize.js"></script>
      <script src="../js/app.js"></script>
      <script type="text/javascript">
         
          $("#logout").click(function(event){
              event.preventDefault();
             
              var currentURL = window.location.origin;
              $.get(currentURL + "/logout").then(function(){
                window.location = "/";
              });
          });


      $('#clearModal').on("click", function() {
          $('#product_name').val('');
          $('#product_description').val('');
          $('#imageURL').val('');
          $(".with-gap").prop('checked',false);
      });

          $('#postProduct').on("click", function() {
            var userInput = {
              product_name: $('#product_name').val().trim(),
              description: $('#product_description').val().trim(),
              imageURL: $('#imageURL').val().trim(),
              category: $('input[name="category"]:checked').val(),
              scaleRating: $('input[name="condition"]:checked').val().trim(),
              UsersId: 1,
              swapStatus: false
            }

            var currentURL = window.location.origin;

            $.post(currentURL + '/api/newproduct', userInput, function(data) {

       

              $('#postAProduct').closeModal();

              window.location.replace("/users/" + data.email);


            });

            return false;
          });

          $('#startSwap').on("click", function() {

            alert("testing");

            //$('#wantedProduct').atr(src, )

          });


      </script>
    </body>
</html>
